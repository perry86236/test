<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>世界災難</title>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <!-- <link href="css/bootstrap.min.css" rel="stylesheet"> -->
  <link href="css/style.css" rel="stylesheet">
  <link href="global_news.css" rel="stylesheet">
</head>

<body>
  <div class="text-center"
    style="background-position: center center; background-image: url(http://perry86236.github.io/test/pic.jpg); background-size: cover;">
    <div class="pt-10 text-5xl font-semibold text-white">世界災難新聞</div>
    <div class="text-white pb-10 ">關心了解週邊的眾生，以慈悲心設想如何幫助眾生。</div>
  </div>
  <div id="app">
    <div class="md:px-20 pt-5 pb-3">固定每週更新一次。</div>
    <div v-for="item in data">
      <div class="ps-2 pt-3 text-left font-semibold md:px-20">搜尋日期：<span v-text=" item.YMD"></span></div>
      <div class="md:flex">
        <div class="md:shrink-0">
          <div class="h-auto w-full object-cover ps-2 pt-3 font-semibold md:h-auto md:w-auto md:pl-20 pr-5">新聞標題</div>
        </div>
        <div class="p-2">
          <a v-for="sub_item in item.data" v-text="sub_item.text" :href="sub_item.link"
            class="mt-1 block py-1 text-lg font-medium leading-tight text-blue-700 hover:underline"></a>
        </div>
      </div>
    </div>
  </div>


  <!-- <div class="jumbotron text-center"
    style="background-position: center center; background-image: url(http://perry86236.github.io/test/pic.jpg); background-size: cover;">
    <h1 class="text-white">世界災難<br>新聞</h1>
    <p class="text-white">關心了解週邊的眾生，<br>以慈悲心設想如何幫助眾生。</p>

  </div>
  <div id="app">
    <div v-for="item in data">
      <div class="font-semibold text-left pt-3 ps-2">搜尋日期：<span v-text="item.YMD"></span></div>
      <div class="md:flex">
        <div class="md:shrink-0">
          <div class="h-auto w-full object-cover md:h-auto md:w-auto font-semibold pt-3 ps-2">新聞標題</div>
        </div>
        <div class="p-2">
          
          <a v-text="sub_item.text" :href="sub_item.link"
            class="block mt-1 text-lg leading-tight font-medium text-blue-700 hover:underline"></a>

        </div>
      </div>
    </div> -->
  <!-- <div class="container">
      <div class="row">
        <div class="text-danger font-weight-bold" v-text="loading_text+text_point" v-if="data.length==0"></div>
        <div class="col-12" v-else>
          <div v-for="item in data">
            <div v-text="item.YMD"></div>
            <table class="table table-sm table-striped">
              <tbody>
                <tr v-for="sub_item in item.data">
                  <td><a v-text="sub_item.text" :href="sub_item.link"></a></td>
                </tr>
              </tbody>
            </table>

            <hr style="filter: progid:dximagetransform.microsoft.shadow(color:#987cb9,direction:145,strength:15)"
              width="90%" color="#987cb9" size=1>
          </div>
        </div>
      </div>
    </div> -->





  <!-- <div>{{msg}}</div> -->
  </div>
  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/scripts.js"></script>
</body>


<script type="module">


  import { createApp } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'

  createApp({
    data() {
      return {
        // input: "",
        data: [], msg: "", loading_text: "資料系統查詢中", text_point: ""
      }
    },
    computed: {


    },

    methods: {

      sort_date(data) {
        data = data.sort((a, b) => {
          if (a.YMD > b.YMD) {
            return -1;
          }
        });
        return data
      },
      async get_data() {
        //共修4
        let url = "https://script.google.com/macros/s/AKfycbzQkLD390RC_2jR_bW_5PYeyaznoP4mg7N3s4E0Kkzyfds0yxDY_7Ru-9lwSccZodmJ/exec"
        this.data = []
        //if (!!this.name) {
        this.msg = this.loading_text
        await axios.get(url)
          .then((response) => {
            //console.log(response.data)
            this.data = this.sort_date(response.data).map(e => {
              return e
            })
            // let data=this.sort_date(response.data)
            // this.data4=data.map(e=>{
            //     e.item=e.item.replace(/、/g,"\n")
            //     return e
            // })

            this.msg = ""
          })
          .catch((error) => {
            console.log(error)
            this.msg = this.err_text
          })
        //}
      },
    },
    mounted() {
      setInterval(() => {
        let date = new Date()
        let sec = date.getSeconds() % 4 + 1
        this.text_point = "...".repeat(sec)
      }, 1000)


    },
    async created() {
      //this.get_data()
      await this.get_data()



    }
  }).mount('#app')
</script>

</html>
